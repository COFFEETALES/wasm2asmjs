on:
  workflow_call:

jobs:
  build:
    name: "Build ğŸ› ï¸"
    runs-on: ubuntu-latest
    container:
      image: node:24-alpine
    steps:
      - name: "Checkout repo âœ…"
        uses: actions/checkout@v4

      - name: "Install tools ğŸ“¦"
        run: |
          #apk update
          apk add --no-cache nodejs openjdk21-jre yarn
          node --version
          yarn install
          mkdir artifacts_build
          mkdir artifacts_tests

      - name: "Build project ğŸ”§"
        working-directory: artifacts_build
        run: |
          echo "Building project..."
          yarn run closure-checks

      - name: "Build tests ğŸ§ª"
        working-directory: artifacts_tests
        run: |
          ../scripts/wasm2lang_build_tests.sh

      - name: "Upload artifacts-tests artifact ğŸ§°"
        uses: actions/upload-artifact@v4
        with:
          name: artifacts-tests
          path: ./artifacts_tests
          if-no-files-found: error
